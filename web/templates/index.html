<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <title>Intérprete de MLP</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  </head>
  <body>
    <main class="container">
      <h1>Intérprete de Redes Neuronales</h1>
      <p class="lead">
        Describe tu arquitectura con el mini-lenguaje y entrena un modelo sobre MNIST directamente desde la web.
      </p>

      {% if error %}
      <div class="alert alert-error">
        <strong>Error:</strong> {{ error }}
      </div>
      {% endif %}

      <form method="post" class="form">
        <label for="architecture">Arquitectura</label>
        <textarea id="architecture" name="architecture" rows="2">{{ form_data.architecture }}</textarea>

        <div class="form-grid">
          <div>
            <label for="epochs">Épocas</label>
            <input id="epochs" name="epochs" type="number" min="1" value="{{ form_data.epochs }}">
          </div>
          <div>
            <label for="batch_size">Batch size</label>
            <input id="batch_size" name="batch_size" type="number" min="1" value="{{ form_data.batch_size }}">
          </div>
          <div>
            <label for="validation_split">Validación</label>
            <input id="validation_split" name="validation_split" type="number" step="0.01" min="0.05" max="0.4" value="{{ form_data.validation_split }}">
          </div>
          <div>
            <label for="train_size">Ejemplos entrenamiento</label>
            <input id="train_size" name="train_size" type="number" min="0" value="{{ form_data.train_size }}">
          </div>
        </div>

        <button type="submit">Entrenar modelo</button>
      </form>

      {% if view %}
      <section class="results">
        <h2>Resultados</h2>
        <p>Precisión en test: <strong>{{ '%.4f'|format(view.test_accuracy) }}</strong></p>
        <p>Pérdida en test: <strong>{{ '%.4f'|format(view.test_loss) }}</strong></p>
        <div class="plots">
          <figure>
            <img src="data:image/png;base64,{{ view.accuracy_plot }}" alt="Accuracy durante el entrenamiento">
            <figcaption>Accuracy</figcaption>
          </figure>
          <figure>
            <img src="data:image/png;base64,{{ view.loss_plot }}" alt="Pérdida durante el entrenamiento">
            <figcaption>Pérdida</figcaption>
          </figure>
        </div>
      </section>
      {% endif %}
    </main>
  </body>
</html>
